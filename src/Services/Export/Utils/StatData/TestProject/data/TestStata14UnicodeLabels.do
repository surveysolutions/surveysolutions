
// do not edit this file with Notepad.exe

clear all
use "TestStata14UnicodeLabels.dta", clear

assert `"`:data label'"'=="Тест меток значений"
assert c(filedate)=="13 Nov 2015 11:13"
assert c(N)==4
assert c(k)==4
assert `"`: char _dta[comment]'"'=="Comment to this data file. ??????? ???????????."

// check variable names
quietly ds
assert r(varlist)=="V0 V1 V2 V3"

// check variable types
confirm double variable V0
confirm byte variable V1
confirm int variable V2
confirm str2045 variable V3

// check variable labels
assert `"`:variable label V0'"'=="DOUBLE variable"
assert `"`:variable label V1'"'=="BYTE variable"
assert `"`:variable label V2'"'=="INT variable"
assert `"`:variable label V3'"'=="STR variable"

//check variable formats
assert `"`:format V0'"'=="%6.2f"
assert `"`:format V1'"'=="%6.0f"
assert `"`:format V2'"'=="%6.0f"

// check values of V0
local eps=0.000000001
assert reldif(V0[1], 1)<`eps'
assert reldif(V0[2], 2)<`eps'
assert reldif(V0[3], 3)<`eps'
assert reldif(V0[4], -99.321)<`eps'

// check values of V1
assert V1==100

// check values of V2
assert V2[1]==1000
assert V2[2]==1001
assert V2[3]==1002
assert V2[4]==1003

//check values of V3
assert V3[1]==""
assert V3[2]=="АБВГДЕЖЗ"*127+"1234567890123"
assert V3[3]=="abcdefgh"*255+"12345"
assert V3[4]=="123"

// check value labels
assert `"`:value label V0'"'=="V0"
assert `"`:value label V1'"'=="V1"
assert `"`:value label V2'"'=="V2"
// no value labels for V3

assert `"`:label V0 1000'"'=="1000" // unlabelled value
assert `"`:label V0 1'"'=="Первое значение"
assert `"`:label V0 2'"'=="Второе значение"
assert `"`:label V0 3'"'=="Третье значение"

assert `"`:label V1 100'"'=="Ровно сто"
assert `"`:label V1 101'"'=="Сто один"
assert `"`:label V1 102'"'=="102" // unlabelled value

assert `"`:label V2 1000'"'=="Тысяча"
assert `"`:label V2 1001'"'=="Тысяча один"
assert `"`:label V2 1002'"'=="Тысяча два"
assert `"`:label V2 1003'"'=="Тысяча три"

// test is now completed successfully, create the marker
display filewrite("MarkerLabels.txt","ok")

exit, STATA clear

