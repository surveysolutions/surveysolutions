@{
    this.Layout = "~/Views/Shared/_NoAuthenticationLayout.cshtml";
    this.ViewBag.Title = "Control Panel: Revalidate Interviews";
}
<h3>Revalidate Interviews</h3>

<pre id="statusArea" style="height: 500px; overflow-y: scroll;">
Requesting status...
</pre>

@Html.ActionLink("Revalidate All", "RevalidateAllInterviewsWithErrors", new { }, new { @class = "btn btn-primary", onclick = "return confirmAction()" })
@Html.ActionLink("Stop", "StopInterviewRevalidating", new { }, new { @class = "btn btn-danger" })


@section scripts
{


    <script type="text/javascript">
        function confirmAction() {
            var confirmed = confirm("Are you sure you want to revalidate interviews at " + window.location.host + " ?");
            return confirmed;
        }
        function updateReadSideStatus() {
            return $.ajax({
                url: '@Url.Action("GetRevalidateInterviewStatus")',
                data: { timestamp: new Date().getMilliseconds() }
            }).done(function (result) {
                $('#statusArea').text('Updated from server: ' + new Date().toTimeString() + '\r\n\r\n' + result);
            }).fail(function (xhr, status, error) {
                $('#statusArea').text(error + '\r\n' + xhr.responseText + '\r\n\r\nUpdated from server: ' + new Date().toTimeString());
            });
        }

        function updateReadSideStatusNeverending() {
            $.when(updateReadSideStatus()).always(function () {
                setTimeout(updateReadSideStatusNeverending, 1000);
            });
        }

        $(function () {
            updateReadSideStatusNeverending();
        });

    </script>

}