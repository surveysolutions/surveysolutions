<table>
    <tr>
        <td class="title">
            <button type="button" class="close" data-bind="click: $root.closeDetails">&times;</button>
            <div class="row-fluid control-group" data-bind="validationElement: title">
                <label class="control-label required">Title</label>
                <div class="controls">
                    <textarea rows="1" data-bind="autoGrowArea: title" class="span12" maxlength="2000"></textarea>
                </div>
            </div>
        </td>
    </tr>
    <tr>
        <td class="body">
            <div class="container-fluid">
                <div class="form-horizontal">
                    <div class="row-fluid">
                        <div class="control-group" data-bind="validationElement: alias">
                            <label class="control-label required">Variable</label>
                            <div class="controls">
                                <input id="alias" placeholder="var. name" type="text" data-bind="value: alias, valueUpdate: 'afterkeydown'" class="span12" maxlength="32" />
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" data-bind="validationElement: variableLabel">Variable Label</label>
                            <div class="controls">
                                <input id="variableLabel" placeholder="variable label" data-bind="value: variableLabel, valueUpdate: 'afterkeydown'" type="text" class="span12" />
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="control-group" data-bind="validationElement: qtype">
                            <label class="control-label">Type</label>
                            <div class="controls">
                                <select class="span12" data-bind="options: typeOptions, optionsValue: 'key', optionsText: 'value', value: qtype"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="control-group">
                            <div class="controls">
                                <button type="button" data-value="true" data-toggle="checkbox" data-bind="checkedButtons: isMandatory, popover: { content: 'A mandatory question without an answer is an error. It is shown as an error on the interface and in the questionnaire statistics.', title: 'Mandatory question', placement: 'right', trigger: 'hover' }" class="btn btn-small"><i class="icon-exclamation"></i>&nbsp;mandatory</button>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid" data-bind="visible: isFeaturedOptionIsVisible">
                        <div class="control-group" data-bind="validationElement: isFeatured">
                            <div class="controls">
                                <label class="checkbox">
                                    <input type="checkbox" data-bind="checked: isFeatured">
                                    &nbsp;Pre-filled <a href="#" class="btn btn-info btn-small btn-help"
                                                        data-content="Answers for pre-filled questions are provided by HQ or Supervisor. Questions of this type cannot be modified by the enumerator."
                                                        data-original-title="Pre-filled question"
                                                        data-trigger="hover"
                                                        data-html="true"
                                                        data-placement="right"
                                                        data-toggle="popover"><i class="icon-info-sign icon-white"></i></a>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="control-group" data-bind="validationElement: isSupervisorQuestion, visible:  isFeatured() == false && !(qtype() == 'TextList' && isSupervisorQuestion() == false)">
                        <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" data-bind="checked: isSupervisorQuestion">
                                Filled by supervisor
                            </label>
                        </div>
                    </div>
                </div>

                <div data-bind="template: { name: qtype(), data: $data }"></div>

                <div data-bind="visible: isValidationVisible()">


                    <div class="row-fluid">
                        <div class="control-group" data-bind="validationElement: validationExpression">
                            <label>
                                <a href="#" class="btn btn-info btn-small btn-help"
                                   data-content="A logical expression that validates an answer to the current question. Might include values of other questions."
                                   data-original-title="Validation expression"
                                   data-trigger="hover"
                                   data-html="true"
                                   data-placement="right"
                                   data-toggle="popover"><i class="icon-info-sign icon-white"></i></a>Validation expression
                            </label>
                            <div class="controls">
                                <textarea rows="1" data-bind="autoGrowArea: validationExpression, valueUpdate: 'afterkeydown'" class="input-block-level"></textarea>
                            </div>
                        </div>
                    </div>

                    @* <div class="editor-container">
                            <div class="editor" data-bind="ace: validationExpression, aceOptions: { mode: 'ncalc', theme: 'designer' }"></div>
                        </div> <span class="help-inline" data-bind="validationMessage: validationExpression"></span>*@


                    <div class="row-fluid">
                        <div class="control-group" data-bind="validationElement: validationMessage">
                            <label>
                                <a href="#" class="btn btn-info btn-small btn-help"
                                   data-content="Validation message is shown when an answer to the current question fails a validation condition."
                                   data-original-title="Validation message"
                                   data-trigger="hover"
                                   data-html="true"
                                   data-placement="right"
                                   data-toggle="popover"><i class="icon-info-sign icon-white"></i></a>Validation message
                            </label>
                            <div class="controls">
                                <textarea rows="2" data-bind="value: validationMessage, valueUpdate: 'afterkeydown'" class="span12"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <div data-bind="visible: isFeatured() == false">
                    <label>
                        <a href="#" class="btn btn-info btn-small btn-help"
                           data-content="A logical expression that activates(disactivates) the current question(group) depending on the answers on the other questions."
                           data-original-title="Condition expression"
                           data-html="true"
                           data-trigger="hover"
                           data-placement="right"
                           data-toggle="popover"><i class="icon-info-sign icon-white"></i></a>Condition expression
                    </label>


                    <div class="control-group" data-bind="validationElement: condition">
                        <div class="controls">
                            <textarea rows="1" data-bind="autoGrowArea: condition, valueUpdate: 'afterkeydown'" class="input-block-level"></textarea>
                            @* <div class="editor-container" data-bind="validationElement: condition">
                                    <div class="editor" data-bind="ace: condition, aceOptions: { mode: 'ncalc', theme: 'designer' }"></div>
                                </div>*@
                            <span class="help-inline" data-bind="validationMessage: condition"></span>
                        </div>
                    </div>
                </div>

                <div class="row-fluid">
                    <label>Instructions</label>
                    <div>
                        <textarea rows="1" data-bind="autoGrowArea: instruction, valueUpdate: 'afterkeydown'" class="span12"></textarea>
                    </div>
                </div>
            </div>
        </td>
    </tr>
    <tr class="pane-bottom">
        <td>
            <div class="inner">
                <button type="button" class="btn btn-success" data-bind="click: $root.saveQuestion, visible: dirtyFlag().isDirty() || isNew(), enable: errors().length == 0 && canUpdate()"><i class="icon-white icon-ok"></i>Save</button>
                <button type="button" class="btn btn-link cancel-edit" data-bind="click: revert, visible: dirtyFlag().isDirty() && !isNew()"><i class="icon-remove"></i></button>
            </div>
        </td>
    </tr>
</table>


