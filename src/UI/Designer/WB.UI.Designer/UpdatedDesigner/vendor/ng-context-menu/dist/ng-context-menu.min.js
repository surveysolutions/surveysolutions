!function(e){"use strict";e.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{element:null,menuElement:null}}).directive("contextMenu",["$document","ContextMenuService",function(n,t){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled",closeCallback:"&contextMenuClose",marginBottom:"@contextMenuMarginBottom"},link:function(l,o,c){function i(e,t){t.addClass("open");var o,c,i=n[0].documentElement,u=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),a=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),m=t[0].scrollWidth,s=t[0].scrollHeight;if(e.pageX||e.pageY)o=e.pageX,c=e.pageY;else{var d=n[0].body;o=e.clientX+d.scrollLeft+i.scrollLeft,c=e.clientY+d.scrollTop+i.scrollTop}var p=i.clientWidth+u,f=i.clientHeight+a,b=m+o,g=s+c,x=Math.max(o-u,0),v=Math.max(c-a,0);if(b>p&&(x-=b-p),g>f){var y=l.marginBottom||0;v=v-(g-f)-y}t.css("top",v+"px"),t.css("left",x+"px"),r=!0}function u(e){e.removeClass("open"),r&&l.closeCallback(),r=!1}function a(e){!l.disabled()&&r&&27===e.keyCode&&l.$apply(function(){u(t.menuElement)})}function m(e){l.disabled()||!r||2===e.button&&e.target===t.element||l.$apply(function(){u(t.menuElement)})}var r=!1;o.bind("contextmenu",function(n){l.disabled()||(null!==t.menuElement&&u(t.menuElement),t.menuElement=e.element(document.getElementById(c.target)),t.element=n.target,n.preventDefault(),n.stopPropagation(),l.$apply(function(){l.callback({$event:n})}),l.$apply(function(){i(n,t.menuElement)}))}),n.bind("keyup",a),n.bind("click",m),n.bind("contextmenu",m),l.$on("$destroy",function(){n.unbind("keyup",a),n.unbind("click",m),n.unbind("contextmenu",m)})}}}])}(angular);