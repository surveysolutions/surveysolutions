<section id="header" class="row">
    <div class="designer-logo"></div>
    <div class="header-line">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <a href="../../">My Questionnaires</a>
                </li>
                <li><a href="../../public">Public Questionnaires</a></li>
            </ul>
        </div>
        <div class="header-menu">
            This document is <strong>{{questionnaire.isPublic ? 'public' : 'private'}}</strong><span ng-repeat="q in getPersonsSharedWith(questionnaire)">
    <span ng-if="$first">
        , shared with <a href="mailto:{{q.email}}">{{q.email}}</a>
    </span>
    <span ng-if="!$first && $last">
        and <a href="javascript:void(0);" ng-click="showShareInfo()">{{$index}} other</a>
    </span>
</span>
            <div class="buttons">
                <button class="btn" type="button" ng-click="showShareInfo()">Settings</button>
                <a class="btn" ng-href="../../questionnaire/edit/{{questionnaireId}}">Old designer</a>
                <a class="btn" href="../../account/logoff">LOG OUT</a>
            </div>
        </div>
    </div>
    <div class="questionnarie-title">
        <div class="title">
            {{questionnaire.title}} <span class="text-muted">({{questionnaire.questionsCount}}Q, {{questionnaire.groupsCount}}G, {{questionnaire.rostersCount}}R)</span>
            <input id="verification-btn" type="button" class="btn" value="VERIFY" ng-click="verify()" />
            <span id="verify-btn" data-toggle="modal" ng-show="verificationStatus.errorsCount" class="error-message ng-hide">
                <a href="javascript:void(0);"
                   ng-click="verify()"
                   ng-pluralize
                   count="verificationStatus.errorsCount"
                   when="{'one': '1 error',
                          'other': '{} errors'}">
                </a>
            </span>
            <span class="text-success" ng-show="verificationStatus.errorsCount === 0">OK<em>, saved at <span>{{verificationStatus.time | date:'H:mm'}}</span></em></span>
        </div>
    </div>
</section>

<section id="spacer" class="row">
    <div class="left"></div>
    <div class="right"></div>
</section>

<section id="main" class="row">
    <div class="chapter-panel" ng-click="unfold();" ng-class="{unfolded: isFolded }" ng-controller="ChaptersCtrl" ui-tree="chaptersTree" data-empty-place-holder-enabled="false">
        <div class="foldback-button" ng-click="foldback();$event.stopPropagation()"></div>
        <div class="ul-holder">
            <ul class="chapters" ui-tree-nodes ng-model="questionnaire.chapters">
                <li class="chapter-panel-item"
                    ng-repeat="chapter in questionnaire.chapters"
                    ui-tree-node
                    ng-class="{ current: isCurrentChapter(chapter) }">
                    <div class="holder" ng-click="editChapter(chapter);$event.stopPropagation();">
                        <div class="inner">
                            <a class="handler" ui-tree-handle></a>
                            <h1><a ui-sref="questionnaire.chapter.group({ chapterId: chapter.itemId, itemId: chapter.itemId})">{{chapter.title}}</a></h1>
                            <div class="btn-group" dropdown>
                                <a href="javascript:void(0);" data-toggle="dropdown" ng-click="$event.stopPropagation()" class="dropdown-toggle"></a>
                                <ul class="dropdown-menu">
                                    <li><a ng-click="editChapter(chapter);$event.stopPropagation();">Edit</a></li>
                                    <li><a ng-click="cloneChapter(chapter.itemId);$event.stopPropagation();">Clone</a></li>
                                    <li><a ng-click="deleteChapter(chapter);$event.stopPropagation();">Delete</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="button-holder">
                <input type="button" class="btn lighter-hover" value="ADD NEW CHAPTER" ng-click="addNewChapter()">
            </div>
        </div>
    </div>
    <div class="questionnaire-tree" ui-view></div>
</section>

<div id="verification-modal" class="modal fade">
    <div class="modal-dialog">
        <div class="arrow"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><!--&times;--></button>
            </div>
            <div class="modal-body">
                <div>
                    <div id="verify-popover-content">
                        <div class="question-list">
                            <div ng-repeat="error in verificationStatus.errors">
                                <div class="question item">
                                    <div class="icon"></div>
                                    {{error.message}}
                                    <div class="qname-block">{{error.code}}</div>
                                </div>
                                <ul class="error-list">
                                    <li ng-repeat="reference in error.references" ng-click="navigateTo(reference)">
                                        <a href="javascript:void(0);">{{reference.title}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/ng-template" id="moveToChapterSnippet">
    <div class="btn-group dropup">
        <button type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown">
            Move to <span class="caret"></span>
        </button>

        <div role="menu" class="chapter-menu dropdown-menu dropdown-menu-right">
            <h1>Move to another chapter:</h1>
            <ul>
                <li ng-repeat="chapter in questionnaire.chapters">
                    <a ng-click="chapter.itemId == currentChapterId || moveToChapter(chapter.itemId)" ng-disabled="chapter.itemId == currentChapterId" unsaved-warning-clear>
                        {{chapter.title}}
                    </a>
                </li>
            </ul>
        </div>
    </div>
</script>