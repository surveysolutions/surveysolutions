@using WB.Core.BoundedContexts.Headquarters
@using WB.Core.GenericSubdomains.Portable.ServiceLocation
@using WB.UI.Shared.Web.Filters
@using WB.UI.Headquarters.Code

@functions{
    public string TokenHeaderValue()
    {
        AntiForgery.GetTokens(null, out var cookieToken, out var formToken);
        return cookieToken + @":" + formToken;
    }
}

<script type="text/javascript">
    var input = window.input || (function () {
        'use strict';
        return {
            settings: {
                messages: {
                    forbiddenMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_ForbiddenMessage)",
                    unhandledExceptionMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_UnhandledExceptionMessage)",
                    notifyDialogTitle: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyDialogTitle)",
                    notifyDialogText: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyDialogText)",
                    notifyNoMarkersTitle: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyNoMarkersDialogTitle)",
                    notifyNoMarkersText: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyNoMarkersDialogText)",
                    deleteQuestionnaireConfirmationMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_DeleteQuestionnareConfirmation)",
                    notifyMarkersLimitReachedTitle: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyMarkersLimitReachedTitle)",
                    notifyNoMarkersLimitReachedText: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyMarkersLimitReachedText)",
                    deleteMapConfirmationMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_DeleteMapConfirmation)",
                    confirmationNeededTitle: "@Html.ToSafeJavascriptMessage(Pages.ConfirmationNeededTitle)"
                },
                acsrf: {
                    tokenName : '@TokenValidationAuthorizationFilter.Apikey',
                    token : '@TokenHeaderValue()'
                },
                config: {
                    syncQueue: {
                        enabled: @(DependencyResolver.Current.GetService<SyncSettings>().UseBackgroundJobForProcessingPackages ? "true" : "false"),
                        lengthUrl: '@Url.RouteUrl("DefaultApiWithAction", new {httproute = "", controller = "ControlPanelApi", action = "GetIncomingPackagesQueueLength"})'
                    },
                    basePath: '@Url.Content("~/")',
                    dataTableTranslationsUrl: '@Url.RouteUrl("DefaultApi", new {httproute = "", controller = "DataTableTranslations" })'
                },
                clientDateTimeFormat: '@Extensions.ClientDateTimeFormat'
            }
        };
    }(document));
    window.input = input;

    window.CONFIG = {
        verboseMode: false,
        googleApiKey: '@(WB.Core.SharedKernels.SurveyManagement.Web.Code.AppSettings.Instance.GoogleMapApiKey)',
        googleMapsApiBaseUrl:
            '@WB.Core.SharedKernels.SurveyManagement.Web.Code.AppSettings.Instance.GoogleMapApiBaseUrl',
        googleMapsBaseUrl: '@WB.Core.SharedKernels.SurveyManagement.Web.Code.AppSettings.Instance.GoogleMapBaseUrl',
        basePath: '@Url.Content(@"~/")',
        imageGetBase: '@Url.Content("~/api/WebInterviewResources")',
        audioGet: '@Url.Content("~/Resource/AudioRecord")',
        appVersion: '@(DependencyResolver.Current.GetService<WB.Core.Infrastructure.Versions.IProductVersion>())',
        dateFormat: '@WB.Core.BoundedContexts.Headquarters.Extensions.ClientDateTimeFormat',
        signalrPath: '@Url.Content("~/signalr/hubs")',
        supportedTransports: ["webSockets", "longPolling"]
    }

    if (typeof moment !== 'undefined') {
        moment.locale('@UICulture');
    }
</script>
