@using WB.Core.BoundedContexts.Headquarters
@using WB.Core.GenericSubdomains.Portable.ServiceLocation
@using WB.UI.Headquarters.Resources
@using WB.UI.Shared.Web.Filters
@using WB.UI.Headquarters.Code

@functions{
    public string TokenHeaderValue()
    {
        string cookieToken, formToken;
        AntiForgery.GetTokens(null, out cookieToken, out formToken);
        return cookieToken + ":" + formToken;
    }
}

<script type="text/javascript">
    var input = window.input || (function () {
        'use strict';
        return {
            settings: {
                messages: {
                    forbiddenMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_ForbiddenMessage)",
                    unhandledExceptionMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_UnhandledExceptionMessage)",
                    notifyDialogTitle: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyDialogTitle)",
                    notifyDialogText: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyDialogText)",
                    notifyNoMarkersTitle: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyNoMarkersDialogTitle)",
                    notifyNoMarkersText: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyNoMarkersDialogText)",
                    deleteQuestionnaireConfirmationMessage: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_DeleteQuestionnareConfirmation)",
                    notifyMarkersLimitReachedTitle: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyMarkersLimitReachedTitle)",
                    notifyNoMarkersLimitReachedText: "@Html.ToSafeJavascriptMessage(Pages.GlobalSettings_NotifyMarkersLimitReachedText)"
                },
                acsrf: {
                    tokenName : '@TokenValidationAuthorizationFilter.Apikey',
                    token : '@TokenHeaderValue()'
                },
                config: {
                    syncQueue: {
                        enabled: @(ServiceLocator.Current.GetInstance<SyncSettings>().UseBackgroundJobForProcessingPackages ? "true" : "false"),
                        lengthUrl: '@Url.RouteUrl("DefaultApiWithAction", new {httproute = "", controller = "ControlPanelApi", action = "GetIncomingPackagesQueueLength"})'
                    },
                    basePath: '@Url.Content("~/")',
                    dataTableTranslationsUrl: '@Url.RouteUrl("DefaultApi", new {httproute = "", controller = "DataTableTranslations" })'
                },
                clientDateTimeFormat: '@Extensions.ClientDateTimeFormat'
            }
        };
    }(document));
    window.input = input;

    window.CONFIG = {
        basePath: '@Url.Content(@"~/")',
        dateFormat: '@WB.Core.BoundedContexts.Headquarters.Extensions.ClientDateTimeFormat'
    }
</script>
