@using WB.Core.SharedKernels.SurveyManagement.Web.Models

@{
    ViewBag.Title = Settings.ExportEncryptionSettings;
    Layout = "~/Views/Shared/_LayoutWithoutSidebar.cshtml";
}

@section scripts
{

    @Scripts.Render("~/js/export-settings")

    <script type="text/javascript">
        var $dataUrl = '@Url.RouteUrl("DefaultApiWithAction", new {httproute = "", controller = "ExportSettingsApi", action = "ExportSettings" })';
        var $changeStateUrl = '@Url.RouteUrl("DefaultApiWithAction", new {httproute = "", controller = "ExportSettingsApi", action = "ChangeState" })';
        var $regenPasswordUrl = '@Url.RouteUrl("DefaultApiWithAction", new {httproute = "", controller = "ExportSettingsApi", action = "RegeneratePassword" })';
        var $messageUrl = '@Url.RouteUrl("DefaultApi", new {httproute = "", controller = "AdminSettings" })';

        $(function () {
            var model = new Supervisor.VM.ExportSettings($dataUrl, $changeStateUrl, $regenPasswordUrl, $messageUrl);
            ko.applyBindings(model);
            model.load();
        });

    </script>
}

<div class="row-fluid">
    <h3 class="sinle-line-header">@Settings.Settings_Title : @Settings.ExportEncryption_Title</h3>

    <div class="well well-sm col-sm-6">
        <div class="col-sm-12">
            <div class="form-inline">

                <label>@Settings.EnableEncryption: </label>
                <input type="checkbox" class="wb-checkbox" id="isEnabled" data-bind="checked: isEnabled, click: changeState">

            </div>
            <div class="form-inline">

                <label>@Settings.Password: </label>
                <input type="text" data-bind="textInput: password" readonly="readonly" class="form-control"/>

                <a class="btn btn-default" data-bind="visible: isEnabled, click: regeneratePass">
                    <i class="glyphicon glyphicon-refresh">
                    </i>
                </a>
            </div></div>
    </div>
</div>
<div class="clearfix"></div>
<div class="row-fluid">
    <div class="well well-sm col-sm-6">
        <form class="col-sm-12">
            <div class="form-group">
                <label for="notificationText">@Settings.GlobalNotice: </label>
                <input class="form-control" id="notificationText" type="text" data-bind="value: message" maxlength="1000" />
            </div>
            <button type="button" class="btn btn-primary" data-bind="click: updateMessage">
                Save
            </button>
            <span class="text-success" data-bind="visible: messageUpdated">Message saved</span>
        </form>
    </div>
</div>
<div class="clearfix"></div>
<div class="row-fluid">
    <div class="well well-sm col-sm-6">
        <form action="@Url.Action("UpdateLogo", "Settings")" method="post" enctype="multipart/form-data" class="col-sm-5" data-bind="submit: onLogoSubmit">
            <div class="form-group">
                <label for="notificationText">@Settings.Logo: </label>

                <input type="file" name="logo" accept="image/gif, image/jpeg, image/png" id="logo"/>
            </div>
            <button type="submit" class="btn btn-primary">Save</button>
        </form>
        <div class="col-sm-7">
            <img src="@Url.Content("~/api/CompanyLogo/Thumbnail")"/>
            <form action="@Url.Action("RemoveLogo", "Settings")" method="post">
                <button type="submit" class="btn btn-danger">Remove logo</button>
            </form>

        </div>
    </div>

</div>
<script type="text/html" id="confirm-regenerate-password">
    <h3>
        @Settings.RegeneratePasswordConfirm
    </h3>
</script>
<script type="text/html" id="confirm-change-state-password">
    <h3>
        @Settings.ChangeStateConfirm
    </h3>
</script>