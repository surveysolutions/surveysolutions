<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Target Name="CollectHqApp" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollectHqApp_CustomFiles Include="HqApp\dist\**\*.js;HqApp\dist\**\*.css;HqApp\dist\**\*.json" />
      <CollectHqApp_CustomFiles Include="HqApp\dist\**\*.map" Condition="'$(GIT_BRANCH)' != 'release'"/>

      <FilesForPackagingFromProject Include="%(CollectHqApp_CustomFiles.Identity)">
        <DestinationRelativePath>HqApp\dist\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>

      <PartialViews Include="Views\Shared\partial.*.cshtml" />
      <FilesForPackagingFromProject Include="%(PartialViews.Identity)">
        <DestinationRelativePath>Views\Shared\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>

  <Target Name="CollectHqDepsDist" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollectHqDeps_CustomFiles Include="Dependencies\dist\**\*.*" />
      <FilesForPackagingFromProject Include="%(CollectHqDeps_CustomFiles.Identity)">
        <DestinationRelativePath>Dependencies\dist\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>

  <Target Name="CustomCollectFilesToExternals" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CustomCollectFilesToExternals_CustomFiles Include="Client\**\*" />
      <FilesForPackagingFromProject Include="%(CustomCollectFilesToExternals_CustomFiles.Identity)">
        <DestinationRelativePath>Client\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>

  <Target Name="CollectVendorFileFonts" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollectVendorFileFonts_CustomFiles Include="Dependencies\vendor\bootstrap-sass\assets\fonts\bootstrap\*" />
      <FilesForPackagingFromProject Include="%(CollectVendorFileFonts_CustomFiles.Identity)">
        <DestinationRelativePath>Dependencies\vendor\bootstrap-sass\assets\fonts\bootstrap\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>

  <Target Name="DeleteEsriExtra" AfterTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <PropertyGroup>
      <ArcGISRuntimeFolderMask>ArcGISRuntime*</ArcGISRuntimeFolderMask>
    </PropertyGroup>
    <ItemGroup>
      <ArcGISRuntime Include="$([System.IO.Directory]::GetDirectories(&quot;$(_PackageTempDir)&quot;, &quot;$(ArcGISRuntimeFolderMask)&quot;))" />
    </ItemGroup>
    <Message Text="Delete Esri Extra folder: @(ArcGISRuntime)" Importance="high" />
    <RemoveDir Directories="@(ArcGISRuntime)" />
  </Target>


    <Target Name="DeleteRoslyn" AfterTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
        <PropertyGroup>
            <ArcGISRuntimeFolderMask>bin\roslyn</ArcGISRuntimeFolderMask>
        </PropertyGroup>
        <ItemGroup>
            <ArcGISRuntime Include="$([System.IO.Directory]::GetDirectories(&quot;$(_PackageTempDir)&quot;, &quot;$(ArcGISRuntimeFolderMask)&quot;))" />
        </ItemGroup>
        <Message Text="Delete Roslyn folder: @(ArcGISRuntime)" Importance="high" />
        <RemoveDir Directories="@(ArcGISRuntime)" />
    </Target>

</Project>
