<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
<Target Name="Cleanup HqApp" BeforeTargets="BeforeRebuild" Condition="'$(NCrunch)' != '1'">
    <Message Text="Cleaning up HQ App" />
    <ItemGroup>
      <FilesToDelete Include="HqApp\dist\**\*.*" />
    </ItemGroup>
    <Delete Files="@(FilesToDelete)" />
  </Target>
  <!-- HQ APP -->
  <!--<Target Name="RestoreHqAppDeps" BeforeTargets="RunWebpackDev" Condition=" '$(NCrunch)' != '1' And '$(Configuration)' == 'Debug' ">
    <Message Importance="high" Text="Restoring HQ App npm deps" />
    <Exec Command="yarn --version" ContinueOnError="true">
      <Output TaskParameter="ExitCode" PropertyName="ErrorCode" />
    </Exec>
    <Exec Command="yarn --ignore-scripts" WorkingDirectory="HqApp" Condition="'$(ErrorCode)' == '0'" />
    <Exec Command="npm install" WorkingDirectory="HqApp" Condition="'$(ErrorCode)' != '0'" />
  </Target>-->
  
  <!--<Target Name="RunWebpackDev" AfterTargets="AfterBuild" Condition="  '$(NCrunch)' != '1' And '$(Configuration)' == 'Debug' And !Exists('HqApp\dist\app.bundle.js') ">
    <Message Importance="high" Text="Performing dev Webpack build..." />
    <Exec Command="npm run dev -- --no-color" WorkingDirectory="HqApp" />
  </Target>-->
  <!-- /HQ APP -->
 
  <Target Name="CollecHqApp" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollecHqApp_CustomFiles Include="HqApp\dist\**\*.js;HqApp\dist\**\*.css" />
      <FilesForPackagingFromProject Include="%(CollecHqApp_CustomFiles.Identity)">
        <DestinationRelativePath>HqApp\dist\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>

      <PartialViews Include="Views\Shared\partial.*.cshtml" />
      <FilesForPackagingFromProject Include="%(PartialViews.Identity)">
        <DestinationRelativePath>Views\Shared\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>
  <Target Name="CollecHqDepsDist" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollecHqDeps_CustomFiles Include="Dependencies\dist\**\*.*" />
      <FilesForPackagingFromProject Include="%(CollecHqDeps_CustomFiles.Identity)">
        <DestinationRelativePath>Dependencies\dist\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
      
    </ItemGroup>
  </Target>
  <!-- <Target Name="CollectWebInterviewAppFiles" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollectWebInterviewAppFiles_CustomFiles Include="InterviewApp\**\*" />
      <FilesForPackagingFromProject Include="%(CollectWebInterviewAppFiles_CustomFiles.Identity)">
        <DestinationRelativePath>InterviewApp\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target> -->
  <Target Name="CustomCollectFilesToExternals" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CustomCollectFilesToExternals_CustomFiles Include="Externals\**\*" />
      <FilesForPackagingFromProject Include="%(CustomCollectFilesToExternals_CustomFiles.Identity)">
        <DestinationRelativePath>Client\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>
  <Target Name="CollectVendorFileFonts" BeforeTargets="CopyAllFilesToSingleFolderForPackage;CopyAllFilesToSingleFolderForMsdeploy" Condition="'$(NCrunch)' != '1'">
    <ItemGroup>
      <CollectVendorFileFonts_CustomFiles Include="Dependencies\vendor\bootstrap-sass\assets\fonts\bootstrap\*" />
      <FilesForPackagingFromProject Include="%(CollectVendorFileFonts_CustomFiles.Identity)">
        <DestinationRelativePath>Dependencies\vendor\bootstrap-sass\assets\fonts\bootstrap\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
      </FilesForPackagingFromProject>
    </ItemGroup>
  </Target>
  </Project>