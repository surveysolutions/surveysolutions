@using System.Web.Optimization
@using Web.Supervisor.Code
@using Web.Supervisor.Models
<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="@Url.Content("~/Content/favicon.png")" />
    @{
        var page = ViewBag.ActivePage ?? MenuItem.Logon;
    }
    @Styles.Render("~/Content/main")
    @RenderSection("styles", false)
</head>
<body>
    <div id="splash-screen">
        @RenderSection("splash_screen", false)
    </div>
    <div class="container-fluid">
        <div class="navbar navbar-fixed-top hidden-print">
            <div class="navbar-inner">
                @if (User.IsInRole("Headquarter"))
                {
                    <a class="brand" href="@Url.Action("Index", "HQ")"><span>Dashboard<span>headquarters</span></span></a>
                    <ul class="nav" role="menu">
                        <li class="dropdown @(page == MenuItem.Surveys || page == MenuItem.Summary || page == MenuItem.Statuses ? "active" : "")">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-th"></i>Reports <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li class="@(page == MenuItem.Surveys ? "active" : "")" ><a href="@Url.Action("SurveysAndStatuses", "HQ")">Surveys and Statuses</a></li>
                                <li class="@(page == MenuItem.Summary ? "active" : "")"><a href="@Url.Action("SupervisorsAndStatuses", "HQ")">Teams and Statuses</a></li>
                            </ul>
                            <li class="@(page == MenuItem.Docs ? "active" : "")">
                                <a href="@Url.Action("Interviews", "HQ")"><i class="icon-list-alt"></i>Interviews</a>
                            </li>
                        <li class="@(page == MenuItem.Teams ? "active" : "")">
                            <a href="@Url.Action("Index", "Team")"><i class="icon-user"></i>Supervisors</a>
                        </li>
                        <li class="@(page == MenuItem.Questionnaires ? "active" : "")">
                            <a href="@Url.Action("Index", "HQ")"><i class="icon-list"></i>Questionnaries</a>
                        </li>
                    </ul>
                    <ul class="nav pull-right" role="menu">
                        <li class="dropdown @(page == MenuItem.Administration ? "active" : "")">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Administration <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li>@Html.ActionLink("Import template", "Import", "Template")</li>
                                <li>@Html.ActionLink("Backup", "Index", "Backup")</li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hi, <b>@User.Identity.Name</b> <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li>@Html.ActionLink("Logoff", "LogOff", "Account")</li>
                            </ul>
                        </li>
                    </ul>
                }
                else
                {
                    <a class="brand" href="@Url.Action("Index", "Survey")"><span>Dashboard<span>supervisor</span></span></a>
                    <ul class="nav" role="menu">
                        <li class="dropdown @(page == MenuItem.Surveys || page == MenuItem.Summary || page == MenuItem.Statuses ? "active" : "")">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-th"></i>Reports <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li class="@(page == MenuItem.Surveys ? "active" : "")" ><a href="@Url.Action("Index", "Survey")">Surveys and Statuses</a></li>
                                <li class="@(page == MenuItem.Summary ? "active" : "")"><a href="@Url.Action("TeamMembersAndStatuses", "Survey")">Team members and Statuses</a></li>
                            </ul>
                            <li class="@(page == MenuItem.Docs ? "active" : "")">
                                <a href="@Url.Action("Interviews", "Survey")"><i class="icon-list-alt"></i>Interviews</a>
                            </li>
                        <li class="@(page == MenuItem.Teams ? "active" : "")">
                            <a href="@Url.Action("Interviewers", "Team")"><i class="icon-user"></i>Interviewers</a>
                        </li>
                    </ul>
                    <ul class="nav pull-right" role="menu">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hi, <b>@User.Identity.Name</b> <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li>@Html.ActionLink("Logoff", "LogOff", "Account")</li>
                            </ul>
                        </li>
                    </ul>
                }
            </div>

        </div>
        <div class="ui-pnotify" data-bind="visible: IsNotifyVisible()" style="display: none">
            <div class="alert ui-pnotify-container ui-pnotify-shadow">
                <div class="ui-pnotify-icon"><span class="icon-exclamation-sign"></span></div>
                <h4 class="ui-pnotify-title" data-bind="text: NotifyTitle()"></h4>
                <div class="ui-pnotify-text" data-bind="html: NotifyText()"></div>
            </div>
        </div>
        <div id="wrapper">
            <div id="umbrella">
                <div id="umbrella-message">
                    Loading, please wait
                </div>
            </div>
            @RenderBody()
            <div id="output">
                <div class="inner">
                    <div class="title">
                        <button type="button" class="close" data-bind="click: HideOutput">&times;</button>
                        <span>Errors log</span>
                    </div>
                    <div class="body">
                        <div class="container-fluid">
                            <div class="form-horizontal">
                                <ul data-bind="foreach: Errors" class="error-list">
                                    <li class="error">
                                        <pre data-bind="html: error"></pre>
                                    </li>
                                </ul>
                                @RenderSection("output", false)
                               
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row-fluid" id="footer-block">
        <hr>
        <footer>
            <div class="text-center">
                © 2013 <a href="http://www.worldbankgroup.org">The World Bank Group</a>, All Rights Reserved. <a href="http://go.worldbank.org/OS6V7NIUD0">Legal</a>.
            </div>
            <div class="text-center">
                @ViewContext.Controller.GetType().Assembly.GetName().Version @*(@File.GetCreationTime(ViewContext.Controller.GetType().Assembly.Location).ToString("dd-MMM-yyyy HH:mm")) *@
                @if (AppSettings.IsDebugBuilded)
                {
                    <span id="build-config">[.NET Debug]</span>
                }
                @if (HttpContext.Current.IsDebuggingEnabled)
                {
                    <span id="compile-config" style="color: red">Web Debug</span>
                }
                | <a href="@Url.Action("GetLatestVersion", "Sync")">Get CAPI</a>
            </div>
        </footer>
    </div>
    @Scripts.Render("~/js/main")
    <script type="text/javascript">
        var input = window.input || (function () {
            'use strict';
            return {
                settings: {
                    messages: {
                        unhandledExceptionMessage: 'An unexpected error occurred. We are sorry for inconvenience. Please try to refresh this page and if this error will occure again, contact support via following email: <a href="mailto:@AppSettings.Instance.AdminEmail">@AppSettings.Instance.AdminEmail</a>',
                        notifyDialogTitle: 'Please wait',
                        notifyDialogText: '"Your previous request is not complete. Please wait for it to be finished and repeat your operation."'
                    }
                }
            };
        }(document));

        window.input = input;

        var setMinHeight = function () {
            var windowHeight = $(window).height();
            var navigationHeight = $('.navbar.navbar-fixed-top').height();
            $('#content').css('min-height', (windowHeight - navigationHeight) + 'px');
            $('#wrapper').css('margin-top', navigationHeight + 'px');
            $('#umbrella').css('top', navigationHeight + 'px');

        };

        $(document).ready(function () {
            setMinHeight();
            $(window).resize(function () {
                setMinHeight();
            });
        });
    </script>
    @RenderSection("scripts", false)
</body>
</html>
