@using Questionnaire.Core.Web.Helpers
@using RavenQuestionnaire.Core.Entities.SubEntities
@using RavenQuestionnaire.Core.Views.Answer
@model RavenQuestionnaire.Core.Views.Question.CompleteQuestionView
@{ ((IDictionary<string, object>)ViewBag.EnabledRadioBoxSettings).Add("onclick", "$(this.form).submit();"); }
@using (Html.BeginCollectionItem("Answers", true, Model.PublicKey))
{
    @Html.Hidden("QuestionId", Model.PublicKey)
    <ul class="btn-group-vertical">
        @foreach (var item in Model.Answers)
        {
            var selectedClass = item.Selected ? "btn-primary" : "";
            @Html.Hidden("Selected", true)
            <li class="btn @selectedClass ">
                @if (item.AnswerType == AnswerType.Text)
                {
                    <div class="radio">
                        @Html.RadioButton("PublicKey", item.PublicKey, item.Selected, (IDictionary<string, object>)ViewBag.EnabledRadioBoxSettings)
                        @{ Html.RenderPartial(string.Format("~/Views/Answer/answerView/_{0}.cshtml", item.AnswerType), item); }
                    </div>
                }
                else
                {
                    <label class="radio">
                        @Html.RadioButton("PublicKey", item.PublicKey, item.Selected, (IDictionary<string, object>)ViewBag.EnabledRadioBoxSettings)
                        @{ Html.RenderPartial(string.Format("~/Views/Answer/answerView/_{0}.cshtml", item.AnswerType), item); }
                    </label>
                }
            </li>
        }
    </ul>
    
    <script>
        $("input[name='@Html.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldName("PublicKey")']").change(function (e) {
            var target = $(this);
            target.parent().parent().parent().children('li').removeClass('btn-primary');

            target.parent().parent().addClass('btn-primary');


        });
    </script>
}
