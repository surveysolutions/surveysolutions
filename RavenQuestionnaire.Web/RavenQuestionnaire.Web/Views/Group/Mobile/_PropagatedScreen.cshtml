@using Main.Core.View.Question
@using Questionnaire.Core.Web.Helpers
@model Main.Core.View.Group.PropagatedGroupMobileView
@{ var groupKey = "propagatedGroup" + Model.PropogationKey; }
<ul data-role="listview" data-inset="true" id="@groupKey">
    @foreach (var pquestion in Model.Children.OfType<CompleteQuestionView>())
    {
        <li class="nav-link" data-role="fieldcontain">@* @RenderQuestion(pquestion, !Model.PublicKey, Model.PropogationKey)*@
            <div>
                @using (Ajax.BeginFormHtml5("SaveSingleResultJson", "CompleteQuestionnaire", ViewBag.AjaxOptions as AjaxOptions, new { autocomplete = "off" }))
                {
                    using (Html.BeginCollectionItem("questions", true, pquestion.PublicKey + "_" + Model.PropogationKey))
                    {
                        ViewBag.EnabledRadioBoxSettings = new Dictionary<string, object>();
                        if (!pquestion.Enabled)
                        {
                            ViewBag.EnabledRadioBoxSettings.Add("Disabled", true);
                        }
                        //Html.RenderPartial(string.Format("~/Views/Answer/AnswerListView/_{0}.cshtml", question.QuestionType), question);
                        Html.RenderPartial("~/Views/Question/_TakeRowHtml5.cshtml", pquestion);
                    }
                    using (Html.BeginCollectionItem("settings", true, groupKey + "_" + Model.PropogationKey))
                    {
                    @Html.Hidden("ParentGroupPublicKey", (Guid)ViewBag.CurrentGroupPublicKey)
                    @Html.Hidden("QuestionnaireId", ViewBag.QuestionnaireId as string)
                    @Html.Hidden("PropogationPublicKey", Model.PropogationKey)
                    }
                }
                <div style="margin-top:5px;">
                    @Html.Partial("~/Views/Group/Mobile/_CommentsBlock.cshtml", pquestion)
                </div>
            </div>
        </li>
    }
</ul>
