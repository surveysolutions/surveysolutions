@using Main.Core.View.Group
@using Main.Core.View.Question
@using Questionnaire.Core.Web.Helpers
@using Main.Core.Entities.SubEntities
@model Main.Core.View.Group.CompleteGroupMobileView
@foreach (var item in Model.Children)
{
    if ((item as CompleteQuestionView) != null)
    {
        var question = item as CompleteQuestionView;
    <div class="ui-body ui-body-c">
                @using (Ajax.BeginFormHtml5("SaveSingleResultJson", "CompleteQuestionnaire", new { type = "Html5" }, ViewBag.AjaxOptions as AjaxOptions))
                {
                    using (Html.BeginCollectionItem("questions", true, question.PublicKey))
                    {
                        Html.RenderPartial("~/Views/Question/_TakeRowHtml5.cshtml", question);
                    }
                    using (Html.BeginCollectionItem("settings", true, question.PublicKey))
                    {
                        @Html.Hidden("ParentGroupPublicKey", (Guid)ViewBag.CurrentGroupPublicKey)
                        @Html.Hidden("QuestionnaireId", ViewBag.QuestionnaireId as string)
                    }
                }            
         <div style="margin-top: 5px;">
            @Html.Partial("~/Views/Group/Mobile/_CommentsBlock.cshtml", question)
         </div>   
     </div>  
     <div class="ui-body">&nbsp;</div>
    }
    else
    {
        var @group = item as CompleteGroupMobileView;
        if (@group.PublicKey != Guid.Empty)
        {
            if (@group.Propagated != Propagate.None)
            {
    @Html.Partial("~/Views/Group/Mobile/_CompleteGroup.cshtml", @group)
            }
            else
            {
    <div class="ui-body ui-body-c">
        <div class="group-anchor">
            <a id="screen-ref-@(@group.PublicKey)" class="nav-link" href="#screen-@(@group.PublicKey)" data-role="button" data-corners="false" data-icon="arrow-r" data-iconpos="right">@(@group.Title)</a>
            <script type="text/javascript">
                $('#screen-ref-@(@group.PublicKey)').click(function () {
                    $('.scrollHere').removeClass('scrollHere');
                    $(this).parents('.group-anchor').addClass("scrollHere");
                });
            </script>
            <input type="checkbox" disabled="disabled" style="display: none;" />
        </div>
    </div>
    <div class="ui-body">
        &nbsp;</div>
            }
        }
        else
        {
    @Html.Partial("~/Views/Group/Mobile/_CompleteGroup.cshtml", @group)
        }
    }
}