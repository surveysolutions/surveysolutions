@using RavenQuestionnaire.Core.Views.Questionnaire
@using RavenQuestionnaire.Web.Models
@model Main.Core.View.Questionnaire.QuestionnaireBrowseView
@{
    ViewBag.Title = "Surveys";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="../../Scripts/sorter.js" type="text/javascript"></script>
<script>
    $(document).ready(function() {
        $("#questionnaireTable").tablesorter({
                order: "@Model.Order",
                send: function(data) {
                    $.ajax({
                            type: "POST",
                            url: "@Url.Action("_TableData", "Questionnaire")",
                            data: JSON.stringify({ SortOrder: data, Pager: { Page: @Model.Page , PageSize: @Model.PageSize } }),
                            contentType: 'application/json, charset=utf-8',
                            statusCode: {
                                200: function(response) {
                                    $("#questionnaireTable tbody").html(response);
                                }
                            }
                        });
                }
            });
    });
</script>
<h2>Surveys</h2>
<p>
    @Html.ActionLink("Create New", "Create", null, new { @class = "btn small btn-primary" })
    @Html.ActionLink("Download All", "ExportTemplates", "ImportExport", null, new { @class = "btn small btn-primary" })    
</p>
<table id="questionnaireTable" class="table table-striped table-bordered table-condensed">
    <thead>
        <tr>
            <th sorter='{"key":"Id"}'>
                Id
            </th>
            <th sorter='{"key":"Title"}'>
                Title
            </th>
            <th sorter='{"key":"CreationDate"}'>
                Creation date
            </th>
            @*<th sorter='{"key":"LastEntryDate"}'>Last edit date</th>*@
            <th sorter='{"disable":"true"}'>
                Actions
            </th>
            <th sorter='{"disable":"true"}'>
                Manage
            </th>
            <th sorter='{"disable":"true"}'>
                Export
            </th>
            <th sorter='{"disable":"true"}'>
                Download 
            </th>
        </tr>
    </thead>
    <tbody>
        @Html.Partial("_Table", Model)
    </tbody>
</table>
<div class="pagination">
    @Html.QPager(Model.PageSize, Model.Page, Model.TotalCount, new { order = Model.Order })
</div>
